## Скрипты на bash и python
Заходим в папку parsing_logs (почему-то запуск скрипта не из этой папки приводит к тому что финального файла нигде не могу найти ни в питоне ни в баше).  
Чтоб прогнать баш-скрипт, пишем ./hw.sh <путь до файла с логами>  
Я подготовил парочку файлов в папке logs, но вы можете указать и свои.
Результат пишется в файл results_bash.txt
Результаты досточно человекочитаемые (через cat results_bash.txt все видно), разделитель - перенос строки
Выполнял следующие задания (и в баше и в питоне):
- Общее число запросов
- Число запросов по каждому методу (если по методу нет запросов, то про него просто ничего не пишется)
- Топ-10 запросов по размеру - вывел url, статус-код и размер (в условии вообще написано число запросов, но это какой-то бред, думаю имелся в виду именно размер)
- Топ-10 4** запросов , сгрупированных по url и конкретному статус-коду - вывел один в один, как показал Ярослав в конфе группы
- Топ 10 самых больших 4** запросов - вывел ip, url, статус-код и размер

В питоне также заходим в parsing logs и пишем так: python ./hw.py <директория> --file=<название файла> --jsonify=<True или нет>
Директория указывается обязательно, название файла - опционально ( если файл указан, то парсится только он, если не указан - то все файлы директории)
Если написано --jsonify=True, то дополнительно к текстовому файлу вывода добавляется json файл.Формат почти такой же, как в баше. 
Название .txt или .json файла  зависит от файла с логами, который мы парсили (к нему добавляется analysis)
Все файлы с ркзультатами сохраняются в папке parsing_logs  

Для питона сделана валидация файла (если файл не удовлетворяет лог-формату, кидается исключение)
Для баша толковой обработки ошибок нет (не придумал такой битый файл, который бы баш как-то не обработал)
## Базы данных и ORM
Использовал mariadb 5.5  
В папке db есть файл orm_working.py, который создает таблицу для логов и заполняет ее логами из файла log.txt. 
После этого с помощью sqlalchemy выводятся на экран результаты заданий из первой части дз (общее число запросов, топ-10 по размеру и др)  
Если честно, это задание было не совсем понятным, но Ярослав сказал сделать так.  
Также написан тест на создание этой же таблицы логов (с тем же коннекшном и билдером), но в тесте данные берутся не из файла, а просто одна и таже строка добавляется 25 раз.
## Flask и сокет
Flask-сервер находится в директории mock, сокет-клиент - в  директории http_client.
Клиент выводит респонс как словарь (по сути это и есть формат-json), формат как в условии дз. Это можно првоерить, запустив файл mock_server.py, а затем http_client.py   
Реализовал два ендпоинта - по одному данные кладутся на сервер (POST), по другому забираются (GET). Если я чего-то не доделал, просто снимите мне баллы, я все равно не понял условия((  
Тесты используют моего сокет-клиента, мок поднимается один раз на все тесты.  

##Linux
Я запускал Centos на VirtualBox с образа Ярослава. Если не получается создать виртуалку, можно попробовать отключить secure boot в BIOS.
Обязательно в гипервизоре в сетях надо поставить тип сетевой мост (интерфейс - как у вайфая) !!!
Запускаю centos (если опять ругается при запуске, надо сократить название), ввожу логин и пароль, сразу для облегчения жизни получаю рута через sudo su -
Скачиваю все, что мне может пригодиться:
- yum install epel-release, yum install nginx  - скачиваю nginx
- yum install yum install openssh openssh-server openssh-clients openssl-libs - скачиваю ssh (он вроде и так есть, но не помешает)
- yum install policycoreutils-python - скачиваю semanage
- yum install firewalld - скачиваю фаервол (и делаю systemctl enable --now firewalld)
- yum install net-tools - скачиваю netstat, использую в тестах
В ip a можно узнать ip виртуалки


####SSHD-демон
Конфиг находится в /etc/ssh/sshd.config
Перед изменением можно сделать копирование как правило хорошего тона.
Захожу в конфиг через vi, меняю строку #Port 22 на Port 33000 (мой не дефолтный порт)  .
Далее разрешаю в selinux новый порт:  
semanage port -a -t ssh_port_t -p tcp 33000  
И открываю порт на фаерволе:
- firewall-cmd --add-port=33000/tcp --permanent
- firewall-cmd --reload
- firewall-cmd --remove-service=ssh --permanent 
- firewall-cmd --reload  
И теперь я делаю systemctl restart sshd (именно REstart, а не просто start).
После этого я могу без проблем подключаться с моего клиента.
####NGINX-демон
Конфиг находится в /etc/nginx/nginx.conf
Перед изменением можно сделать копирование как правило хорошего тона.
Захожу в конфиг через vi, в секции listen меняю дефолтный 80 на 3200 (мой не дефолтный).  
Далее разрешаю в selinux новый порт:  
semanage port -a -t http_port_t -p tcp 3200
semanage port -m -t http_port_t -p tcp 3200
И открываю порт на фаерволе:
- firewall-cmd --add-port=3200/tcp --permanent
- firewall-cmd --reload
И делаю systemctl restart nginx  
После этого:  
 a)У меня запускается демон на центоси (без изменений в selinux он бы поругался)  .
 б)У меня есть возможность достучаться до виртуалки из моего основного компа (благодаря настройкам фаервола)
Далее можно запускать тесты и непосредственно убедиться в этом.

